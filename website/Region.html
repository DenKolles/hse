<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>My title</title>
    <link rel="stylesheet" href="./styles/fonts.css">
    <link rel="stylesheet" href="./styles/style.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"> </script>
</head>
<body >
    <header>
        <div class = "left">
            <img class="logo" src="../resources/images/russia.svg">
            <span class="upperCase">Федеральный ресурс о населении</span>
        </div>
        <div class ="right">
            <span >Борисов Сергей Викторович</span>
            <img class="accountPhoto" src="../resources/images/avatar/avatar-header.svg">
        </div>
    </header>
    <nav>
        <div class="header">Фильтры</div>
        <div class="filters scrolled">
            <div>
                <div>ФИО</div>
                <select>
                    <option>Все</option>
                </select>
                <div>Социальный номер</div>
                <select>
                    <option>Все</option>
                </select>
            </div>
            <div>
                <div>Округ</div>
                <select>
                    <option>Центральный федеральный округ</option>
                </select>
                <div>Субъект</div>
                <select>
                    <option>Адыгея</option>
                </select>
            </div>
            <div>
                <div>Гражданство</div>
                <select>
                    <option>Российская Федерация</option>
                </select>
                <div>Возраст</div>
                <select>
                    <option>Не выбрано</option>
                </select>
                <div>Пол</div>
                <table class="radio">
                    <tr>
                        <td>Мужской<input name="sex" type="radio"></td>
                        <td>Женский<input name="sex" type="radio"></td>
                    </tr>
                </table>
                <div>Семейное положение</div>
                <table class="radio">
                    <tr>
                        <td>В браке<input name="famStatus" type="radio"></td>
                        <td>Не в браке<input name="famStatus" type="radio"></td>
                    </tr>
                </table>
                <div>Инвалидность</div>
                <table class="radio">
                    <tr>
                        <td>Есть<input name="disability" type="radio"></td>
                        <td>Нет<input name="disability" type="radio"></td>
                    </tr>
                </table>
            </div>
            <div>
                <div>Занятость</div>
                <select>
                    <option>Работает</option>
                </select>
                <div>Образование</div>
                <select>
                    <option>Дошкольнок</option>
                </select>
                <div>Доход</div>
                <select>
                    <option>Не выбрано</option>
                </select>
            </div>
        </div>
    </nav>
    <main>
        <div class="header">
            <div class="left">
                <img class="back" src="../resources/images/icons/nav-back.svg">
                <span>Назад</span>
                <span class="upperCase region">свердловская обл</span>
                <span>4 794 745</span>
                <span>чел.</span>
            </div>
            <div class="right">
                <span class="date">27.09.2017</span>
                <img src="../resources/images/icons/nav-date.svg">
            </div>
        </div>
        <div class="table scrolled">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>№</th>
                        <th>Фото</th>
                        <th>Социальный номер</th>
                        <th>Фамилия Имя Отчество</th>
                        <th>Возраст</th>
                        <th>Пол</th>
                        <th>Семейное положение</th>
                        <th>Военно-обязанность</th>
                        <th>Занятость</th>
                        <th>Инвалидность</th>
                        <th>Предприниматель</th>
                        <th>Образование</th>
                        <th>Земля</th>
                        <th>Недвижимость</th>
                        <th>Автомобиль</th>
                        <th>Доход</th>
                        <th><img src="../resources/images/icons/nav-place.svg"></th>
                    </tr>
                </thead>
                <tbody>

                </tbody>

            </table>
        </div>
    </main>
</body>

<script>
    $().ready(
        function(){
            $.getJSON("https://raw.githubusercontent.com/IBS-DIvanov/hse/develop/resources/json/temp_short.json",
                function( data ) {
                    $.each(data,
                        function(i, e){
                            var tr = $('<tr></tr>');

                            tr.append("<td>"+e.original.fid+"</td>");
                            tr.append("<td></td>");
                            tr.append("<td>"+e.original.number+"</td>");
                            tr.append("<td>"+e.original.name+"</td>");
                            tr.append("<td>"+age_count(new Date(e.original.birthday))+"</td>");
                            if (e.original.gender == "woman")
                                tr.append("<td><img src='../resources/images/icons/person-woman.svg'></td>")
                            else tr.append("<td><img src='../resources/images/icons/person-man.svg'></td>");
                            tr.append("<td>"+(e.original.married?"<img src='../resources/images/icons/person-married.svg'":"")+"</td>");
                            tr.append("<td>"+(e.original.reservist?"<img src='../resources/images/icons/person-army.svg'":"")+"</td>");
                            tr.append("<td>"+(e.original.employment?"Работает":"Не работает")+"</td>");
                            tr.append("<td>"+(e.original.disability?"<img src='../resources/images/icons/person-disability.svg'":"")+"</td>");
                            tr.append("<td>"+(e.original.business?"<img src='../resources/images/icons/person-business.svg'":"")+"</td>");
                            tr.append("<td>"+"Не знаю"+"</td>");
                            tr.append("<td>"+(e.original.hasLand?"<img src='../resources/images/icons/person-hasLand.svg'":"")+"</td>");
                            tr.append("<td>"+(e.original.hasProperty?"<img src='../resources/images/icons/person-hasProperty.svg'":"")+"</td>");
                            tr.append("<td>"+(e.original.hasProperty?"<img src='../resources/images/icons/person-hasProperty.svg'":"")+"</td>");
                            tr.append("<td>"+e.original.income+"</td>");

                            $('#dataTable tbody').append(tr);
                        }
                    );

                    function age_count(date) {
                        var d = new Date(date).toISOString();
                        // now
                        var now = new Date();
                        now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
                        now = now.toISOString().substr(0, 19).replace('T',' ');
                        // calculate
                        var age = now.substr(0, 4) - d.substr(0, 4);
                        if(now.substr(5) < d.substr(5)) --age;
                        // output
                        return age;
                    }
                }
            );
        }
    );
</script>
</html>

<!-- some debug -->
<script>setTimeout(function(){ location.reload() }, 300000);</script>